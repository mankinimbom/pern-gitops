# Production-specific Rollout configuration patches
---
# Backend Rollout Production Configuration
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: backend
  namespace: pern-app-production
spec:
  replicas: 5
  strategy:
    canary:
      steps:
      - setWeight: 5
      - pause: {duration: 300s}
      - analysis:
          templates:
          - templateName: success-rate-analysis
          - templateName: database-performance-analysis
          args:
          - name: service-name
            value: production-backend-canary-service-prod
          - name: namespace
            value: pern-app-production
      - setWeight: 10
      - pause: {duration: 600s}
      - setWeight: 25
      - pause: {duration: 900s}
      - analysis:
          templates:
          - templateName: success-rate-analysis
          - templateName: database-performance-analysis
          - templateName: comprehensive-health-analysis
          args:
          - name: service-name
            value: production-backend-canary-service-prod
          - name: namespace
            value: pern-app-production
      - setWeight: 50
      - pause: {duration: 1200s}
      - setWeight: 75
      - pause: {duration: 1800s}
      - analysis:
          templates:
          - templateName: success-rate-analysis
          - templateName: database-performance-analysis
          - templateName: comprehensive-health-analysis
          args:
          - name: service-name
            value: production-backend-canary-service-prod
          - name: namespace
            value: pern-app-production

---
# Frontend Rollout Production Configuration  
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: frontend
  namespace: pern-app-production
spec:
  replicas: 4
  strategy:
    canary:
      steps:
      - setWeight: 5
      - pause: {duration: 180s}
      - analysis:
          templates:
          - templateName: frontend-performance-analysis
          args:
          - name: service-name
            value: production-frontend-canary-service-prod
          - name: namespace
            value: pern-app-production
      - setWeight: 10
      - pause: {duration: 300s}
      - setWeight: 20
      - pause: {duration: 600s}
      - analysis:
          templates:
          - templateName: frontend-performance-analysis
          - templateName: success-rate-analysis
          args:
          - name: service-name
            value: production-frontend-canary-service-prod
          - name: namespace
            value: pern-app-production
      - setWeight: 50
      - pause: {duration: 900s}
      - setWeight: 75
      - pause: {duration: 1200s}
      - analysis:
          templates:
          - templateName: frontend-performance-analysis
          - templateName: success-rate-analysis
          - templateName: comprehensive-health-analysis
          args:
          - name: service-name
            value: production-frontend-canary-service-prod
          - name: namespace
            value: pern-app-production
